(function(n){n.fn.extend({BingMap:function(t){var i={Height:400,Width:400,APIKEY:"",Address:"",Latitude:"",Longitude:"",Title:"",Description:"",ZoomLevel:4,MapMode:"2D",MapStyle:"Aerial",PushPin:!0,ShowDashBoard:!0,ShowScaleBar:!0,DashBoardStyle:"Normal",AllowMouseWheelZoom:!0},t=n.extend(i,t);return this.each(function(){var r=n(this),i=t,u,f;n(r).css("width",i.Width+"px"),n(r).css("height",i.Height+"px"),n(r).css("position","relative"),i.Address.length>0&&n.ajax({url:"//dev.virtualearth.net/REST/v1/Locations",dataType:"jsonp",async:!1,data:{key:i.APIKEY,q:i.Address},jsonp:"jsonp",success:function(n){var t=n.resourceSets[0].resources[0].point.coordinates;u=t[0],f=t[1]}}),n.getScript("//dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=6.3",function(){var o,s,c,e;map=new VEMap(n(r).attr("id")),o=i.Latitude.length==0&&u.toString().length>0?u:"",s=i.Longitude.length==0&&f.toString().length>0?f:"";var y=i.Title,p=i.Description,w=i.ZoomLevel,l=i.MapMode,t=i.MapStyle,b=i.PushPin,a=i.ShowDashBoard,k=i.ShowScaleBar,h=i.DashBoardStyle,v=i.AllowMouseWheelZoom;o.length==0||s.length==0?(a==!0?h=="Tiny"?map.SetDashboardSize(VEDashboardSize.Tiny):h=="Small"?map.SetDashboardSize(VEDashboardSize.Small):map.SetDashboardSize(VEDashboardSize.Normal):map.HideDashboard(),map.LoadMap(),l=="2D"?map.SetMapMode(VEMapMode.Mode2D):map.SetMapMode(VEMapMode.Mode3D),t=="Road"?map.SetMapStyle(VEMapStyle.Road):t=="Birdseye"?map.SetMapStyle(VEMapStyle.Birdseye):t=="Hybrid"?map.SetMapStyle(VEMapStyle.Hybrid):map.SetMapStyle(VEMapStyle.Aerial),k==!0?map.ShowScalebar():map.HideScalebar(),map.SetMouseWheelZoomToCenter(v)):(c=new VELatLong(o,s),a==!0?h=="Tiny"?map.SetDashboardSize(VEDashboardSize.Tiny):h=="Small"?map.SetDashboardSize(VEDashboardSize.Small):map.SetDashboardSize(VEDashboardSize.Normal):map.HideDashboard(),map.LoadMap(c,w,VEMapStyle.Aerial),l=="2D"?map.SetMapMode(VEMapMode.Mode2D):map.SetMapMode(VEMapMode.Mode3D),t=="Road"?map.SetMapStyle(VEMapStyle.Road):t=="Birdseye"?map.SetMapStyle(VEMapStyle.Birdseye):t=="Hybrid"&&map.SetMapStyle(VEMapStyle.Hybrid),map.SetMouseWheelZoomToCenter(v),b==!0&&(e=new VEShape(VEShapeType.Pushpin,c),e.SetCustomIcon(null),e.SetTitle(y),e.SetDescription(p),map.AddShape(e)))})})}})})(jQuery)